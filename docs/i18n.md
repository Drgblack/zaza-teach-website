# Internationalization (i18n) Guide

## Overview

This documentation covers the internationalization setup for the Zaza Teach website, which supports English (en) and German (de) locales.

## Table of Contents

1. [Architecture Overview](#architecture-overview)
2. [File Structure](#file-structure)
3. [Adding New Translations](#adding-new-translations)
4. [Creating New Pages](#creating-new-pages)
5. [Blog Localization](#blog-localization)
6. [SEO and hreflang](#seo-and-hreflang)
7. [Development Workflow](#development-workflow)
8. [Testing](#testing)
9. [Troubleshooting](#troubleshooting)

## Architecture Overview

The website uses Next.js App Router with explicit locale-based routing:

- **English**: `/en/*` routes
- **German**: `/de/*` routes
- **Root**: Redirects to default locale

### Key Technologies

- **Next.js 14**: App Router with dynamic routing
- **next-intl**: Translation management and context
- **Custom SEO utilities**: hreflang and locale-aware metadata
- **Locale-aware blog system**: Separate content per language

## File Structure

```
src/
├── i18n/
│   ├── messages/
│   │   ├── en.json          # English translations
│   │   └── de.json          # German translations
│   └── config.ts            # i18n configuration
├── lib/
│   ├── seo.ts              # SEO utilities with hreflang
│   └── blog-locale.ts      # Locale-aware blog functions
└── components/
    ├── LocaleProvider.tsx   # Translation context provider
    └── HrefLangLinks.tsx   # hreflang meta tags

app/
├── en/                     # English routes
│   ├── layout.tsx          # English layout with metadata
│   ├── page.tsx            # English home page
│   ├── blog/
│   │   ├── page.tsx        # Blog index
│   │   └── [slug]/
│   │       └── page.tsx    # Individual blog posts
│   └── [other-pages]/
└── de/                     # German routes
    ├── layout.tsx          # German layout with metadata
    ├── page.tsx            # German home page
    ├── blog/
    │   ├── page.tsx        # German blog index
    │   └── [slug]/
    │       └── page.tsx    # Individual blog posts
    └── [other-pages]/

content/
├── blog/
│   ├── en/                 # English blog posts
│   │   ├── post-1.md
│   │   └── post-2.md
│   └── de/                 # German blog posts
│       ├── post-1.md
│       └── post-2.md
```

## Adding New Translations

### 1. Update Translation Files

Add keys to both `src/i18n/messages/en.json` and `src/i18n/messages/de.json`:

```json
// en.json
{
  "navigation": {
    "home": "Home",
    "about": "About",
    "newFeature": "New Feature"
  }
}

// de.json  
{
  "navigation": {
    "home": "Startseite",
    "about": "Über uns", 
    "newFeature": "Neue Funktion"
  }
}
```

### 2. Use in Components

For **Client Components**:

```tsx
'use client';

import { useTranslations } from 'next-intl';

export default function Navigation() {
  const t = useTranslations('navigation');
  
  return (
    <nav>
      <a href="/home">{t('home')}</a>
      <a href="/about">{t('about')}</a>
      <a href="/new">{t('newFeature')}</a>
    </nav>
  );
}
```

For **Server Components**, translations are provided via LocaleProvider in the layout.

## Creating New Pages

### 1. Create Both Locale Versions

**English Page** (`app/en/new-page/page.tsx`):

```tsx
import { generateSEOMetadata } from '@/lib/seo';
import NewPageClient from './NewPageClient';

export const metadata = generateSEOMetadata({
  title: 'New Page | Zaza Teach',
  description: 'Description of the new page',
  locale: 'en',
  path: 'new-page',
  type: 'website',
});

export default function NewPage() {
  return <NewPageClient />;
}
```

**German Page** (`app/de/new-page/page.tsx`):

```tsx
import { generateSEOMetadata } from '@/lib/seo';
import NewPageClient from './NewPageClient';

// Mark as dynamic if using translations
export const dynamic = 'force-dynamic';

export const metadata = generateSEOMetadata({
  title: 'Neue Seite | Zaza Teach',
  description: 'Beschreibung der neuen Seite',
  locale: 'de',
  path: 'new-page',
  type: 'website',
});

export default function NewPage() {
  return <NewPageClient />;
}
```

### 2. Create Client Component

**Client Component** (`app/de/new-page/NewPageClient.tsx`):

```tsx
'use client';

import { useTranslations } from 'next-intl';

export default function NewPageClient() {
  const t = useTranslations('newPage');
  
  return (
    <div>
      <h1>{t('title')}</h1>
      <p>{t('description')}</p>
    </div>
  );
}
```

### 3. Add Translations

Add the necessary keys to both translation files:

```json
// en.json & de.json
{
  "newPage": {
    "title": "Page Title",
    "description": "Page description"
  }
}
```

## Blog Localization

### 1. File Structure

Blog posts are stored in locale-specific directories:

```
content/blog/
├── en/
│   └── my-post.md
└── de/
    └── my-post.md
```

### 2. Blog Post Format

Each blog post should have frontmatter with locale-appropriate content:

**English** (`content/blog/en/my-post.md`):
```markdown
---
title: "My Blog Post"
description: "A description of my blog post"
slug: "my-post"
date: "2024-01-15"
image: "https://example.com/image.jpg"
tags: ["Education", "AI", "Teaching"]
author: "Author Name"
---

Your blog content here...
```

**German** (`content/blog/de/my-post.md`):
```markdown
---
title: "Mein Blog-Beitrag"
description: "Eine Beschreibung meines Blog-Beitrags"
slug: "my-post"
date: "2024-01-15"  
image: "https://example.com/image.jpg"
tags: ["Bildung", "KI", "Unterricht"]
author: "Autor Name"
---

Ihr Blog-Inhalt hier...
```

### 3. Blog Utilities

The `lib/blog-locale.ts` file provides locale-aware blog functions:

```tsx
import { getAllSlugs, getPost, getAllPosts } from '@/lib/blog-locale';

// Get all blog posts for a locale
const posts = getAllPosts('de');

// Get a specific post
const post = getPost('my-post', 'de');

// Get all slugs for static generation
const slugs = getAllSlugs('de');
```

## SEO and hreflang

### 1. SEO Utilities

The `lib/seo.ts` file provides comprehensive SEO functions:

```tsx
import { generateSEOMetadata } from '@/lib/seo';

export const metadata = generateSEOMetadata({
  title: 'Page Title',
  description: 'Page description',
  keywords: ['keyword1', 'keyword2'],
  locale: 'de',
  path: 'my-page',
  type: 'website',
});
```

### 2. hreflang Implementation

Each page automatically generates hreflang tags:

```html
<link rel="alternate" hreflang="en" href="https://zazateach.com/en/my-page" />
<link rel="alternate" hreflang="de" href="https://zazateach.com/de/my-page" />
<link rel="alternate" hreflang="x-default" href="https://zazateach.com/en/my-page" />
```

### 3. Layout Configuration

Each locale has its own layout with proper metadata:

```tsx
// app/de/layout.tsx
export const metadata: Metadata = generateSEOMetadata({
  title: 'Zaza Teach | KI-Unterrichtsplanung für Pädagogen',
  description: 'German description...',
  locale: 'de',
  path: '',
});
```

## Development Workflow

### 1. Adding New Features

1. **Plan translations early**: Identify all user-facing text
2. **Add translation keys**: Update both en.json and de.json
3. **Create components**: Use useTranslations hook in client components
4. **Test both locales**: Verify functionality in both languages
5. **Run i18n checks**: Use `npm run check:i18n`

### 2. Best Practices

- **Use semantic key names**: `navigation.home` instead of `nav1`
- **Group related translations**: Keep related keys in the same namespace
- **Consistent formatting**: Use consistent capitalization and punctuation
- **Cultural adaptation**: Adapt content for German educational context, not just literal translation
- **Dynamic pages**: Mark pages using translations as `force-dynamic`

### 3. German Language Guidelines

- **Quotation marks**: Use German quotes („text") instead of English ("text")
- **Educational terms**: Use proper German educational terminology
- **Formal address**: Use formal "Sie" form for user-facing content
- **Compound words**: Use proper German compound word formation
- **School system**: Adapt references to match German education system

## Testing

### 1. Automated Testing

Run the i18n validation script:

```bash
# Check translation completeness and consistency
npm run check:i18n

# Check build with both locales
npm run build

# Run type checking
npm run typecheck
```

### 2. Manual Testing

1. **Route testing**: Verify both `/en/page` and `/de/page` work
2. **Content verification**: Check all German content displays correctly
3. **SEO validation**: Verify hreflang tags and metadata
4. **Link verification**: Ensure internal links point to correct locale

### 3. CI/CD Integration

The project includes GitHub Actions workflows:

- **`.github/workflows/ci.yml`**: General CI with i18n checks
- **`.github/workflows/i18n.yml`**: Detailed translation validation

## Troubleshooting

### Common Issues

1. **Translation keys not found**
   - Check if keys exist in both en.json and de.json
   - Verify the key path is correct
   - Run `npm run check:i18n` to identify missing keys

2. **Build errors with translations**
   - Add `export const dynamic = 'force-dynamic'` to pages using client translations
   - Check that useTranslations is only used in client components

3. **SEO metadata not working**
   - Verify generateSEOMetadata is imported correctly
   - Check that locale and path parameters are correct
   - Ensure siteUrl is configured in lib/site.ts

4. **German content showing English**
   - Check that German translation keys exist
   - Verify the page is marked as dynamic if needed
   - Check LocaleProvider is correctly set up in layout

5. **hreflang issues**
   - Verify HrefLangLinks component is included in layouts
   - Check that alternate URLs are generated correctly
   - Use browser dev tools to inspect meta tags

### Debugging Commands

```bash
# Validate all translations
npm run check:i18n

# Check specific translation file syntax
cat src/i18n/messages/de.json | jq .

# Find translation usage in code
grep -r "useTranslations" app/ components/

# Check build output for both locales
ls -la .next/server/app/
```

## Migration Guide

### From Hardcoded Text to Translations

1. **Identify hardcoded text** in components
2. **Extract to translation keys** in appropriate namespace
3. **Convert component** to use useTranslations
4. **Test both locales** thoroughly
5. **Update CI checks** to catch future hardcoded text

### Adding New Locales

To add a new locale (e.g., French):

1. **Create translation file**: `src/i18n/messages/fr.json`
2. **Add locale routing**: Create `app/fr/` directory structure
3. **Update SEO utilities**: Add French locale to lib/seo.ts
4. **Update i18n config**: Add 'fr' to supported locales
5. **Create blog directory**: `content/blog/fr/`
6. **Update CI workflows**: Include French validation

## Maintenance

### Regular Tasks

1. **Translation audits**: Run `npm run check:i18n` regularly
2. **Content reviews**: Periodically review German translations for accuracy
3. **SEO monitoring**: Check hreflang implementation in production
4. **Link validation**: Verify all internal links work in both locales
5. **Performance monitoring**: Monitor impact of dynamic pages on performance

### Version Control

- **Translation files**: Always commit both en.json and de.json together
- **Feature branches**: Include translations in the same PR as features
- **Review process**: Have German translations reviewed by native speakers
- **Documentation**: Keep this guide updated with new patterns and requirements

---

## Support

For questions about the i18n implementation:

1. Check this documentation first
2. Run `npm run check:i18n` for validation issues
3. Review the GitHub Actions workflow outputs
4. Check the existing translation patterns in the codebase

This documentation should be updated whenever new i18n patterns or requirements are added to the project.